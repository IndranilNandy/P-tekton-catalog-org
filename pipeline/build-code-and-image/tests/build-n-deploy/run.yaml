apiVersion: tekton.dev/v1
kind: PipelineRun
metadata:
  generateName: build-n-deploy-r-
spec:

  taskRunTemplate:
    serviceAccountName: test-service-account
    podTemplate:
      securityContext:
        fsGroup: 65532

  workspaces:
    - name: shared-workspace
      persistentVolumeClaim:
        claimName: test-catalog-pipeline-build-n-deploy-pipeline-pvc
      subPath: kaniko-pipeline/

    # - name: ssh-directory
    #   secret:
    #     secretName: git-creds-ssh-secret-3

    # - name: docker-credentials
    #   secret:
    #     secretName: test-docker-credentials

  pipelineRef:
    resolver: git
    params:
      - name: repo
        value: P-tekton-catalog-org
      - name: pathInRepo
        value: pipeline/build-code-and-image/build-n-deploy-pipeline.yaml